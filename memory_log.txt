__main__ main:78                                  :458.7  Mb     args = parse_args()
__main__ main:92                                  :527.7  Mb     print_model_info(model)
__main__ main:101                                 :160.0  Mb     print_model_info(draft_model)
decoding staged_speculative_decoding:166          :250.0  Mb     total_length = model_outputs.logits.shape[1]
decoding staged_speculative_decoding:188          :100.0  Mb     draft_past_key_values = draft_outputs.past_key_values
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :338.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :252.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :2.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :2.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :2.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :336.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :336.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :308.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :308.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :308.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :308.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :2.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :308.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :308.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :308.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :308.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :308.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :308.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :308.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :308.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :308.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :308.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :308.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :384.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :2.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :384.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :2.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :352.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :352.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :352.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :2.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :352.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :352.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :352.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :2.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :352.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :352.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :2.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :352.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :352.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :2.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :352.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :352.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :352.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :352.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :352.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :432.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding staged_speculative_decoding:229          :72.0   Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :2.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :396.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :396.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :396.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :396.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :8.0    Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :396.0  Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
__main__ print_model_info:63                      :986.4  Mb :986.4  Mb     params = sum(p.numel() for p in model.parameters())
__main__ print_model_info:63                      :160.0  Mb :1146.4 Mb     params = sum(p.numel() for p in model.parameters())
decoding staged_speculative_decoding:166          :250.0  Mb :1396.4 Mb     total_length = model_outputs.logits.shape[1]
decoding staged_speculative_decoding:188          :100.0  Mb :1496.4 Mb     draft_past_key_values = draft_outputs.past_key_values
decoding get_next_inputs:60                       :4.0    Mb :1500.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :1506.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :1510.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :1514.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :1520.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :1524.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :1530.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :1534.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :1538.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :1544.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :1548.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :1554.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :1558.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :338.0  Mb :1896.4 Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb :1900.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :1904.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :1910.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :1914.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :1920.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :1924.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :1928.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :1934.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :1938.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :1944.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :1948.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :1952.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :1958.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :252.0  Mb :2210.4 Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb :2216.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :2220.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :2226.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :2230.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :2234.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :2240.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :2244.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :2250.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :2254.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :2258.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :2264.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb :2528.4 Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb :2534.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :2538.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :2544.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :2548.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :2552.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :2558.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :2562.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :2568.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :2572.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :2576.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :2582.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb :2846.4 Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :6.0    Mb :2852.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :2856.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :2862.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :2866.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :2870.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :2876.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :2880.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :2886.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :2890.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :2894.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :2900.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb :3164.4 Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb :3168.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3174.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :3178.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :3182.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3188.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :3192.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3198.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :3202.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :3206.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3212.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :4.0    Mb :3216.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb :3480.4 Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb :3484.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3490.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3496.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3502.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3508.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3514.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3520.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3526.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3532.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3538.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3544.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3550.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb :3814.4 Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :2.0    Mb :3816.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3822.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3828.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3834.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3840.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3846.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3852.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3858.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3864.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3870.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :3876.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb :4140.4 Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb :4144.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4150.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4156.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4162.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4168.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4174.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4180.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4186.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4192.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4198.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb :4462.4 Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :2.0    Mb :4464.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4470.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4476.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4482.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4488.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4494.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4500.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4506.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4512.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4518.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb :4782.4 Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb :4786.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4792.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4798.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4804.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4810.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4816.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4822.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4828.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4834.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :4840.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding staged_speculative_decoding:229          :264.0  Mb :5104.4 Mb         new_logits = model_outputs.logits[:, -depth - 1 :]
decoding get_next_inputs:60                       :4.0    Mb :5108.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :5114.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :5120.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :5126.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :5132.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :5138.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :5144.4 Mb         next_token_logits = outputs.logits[:, -1, :]
decoding get_next_inputs:60                       :6.0    Mb :5150.4 Mb         next_token_logits = outputs.logits[:, -1, :]
